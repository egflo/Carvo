
<div class="container-main">
  <div class="filter-container">
    <cdk-accordion class="accordion">
      <cdk-accordion-item
        #accordionItemLocation="cdkAccordionItem"
        class="accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-location'"
        [attr.aria-expanded]="accordionItemLocation.expanded"
        [attr.aria-controls]="'accordion-body-location'">
        <div class="accordion-item-header" (click)="accordionItemLocation.toggle()">
          Location
          <span class="accordion-item-description">
            <mat-icon
              class="accordion-item-icon"
              [color]="'primary'"
            >
              {{ accordionItemLocation.expanded ? 'expand_less'  : 'expand_more' }}</mat-icon>
          </span>
        </div>
        <div
          class="accordion-item-body"
          role="region"
          [style.display]="accordionItemLocation.expanded ? '' : 'none'"
          [attr.id]="'accordion-body-location'"
          [attr.aria-labelledby]="'accordion-header-location'">
          <div class = "location-container">
            <div class="form-row align-items-center">
              <div class="col-auto my-1">
                <div class="mb-3">
                  <label for="postcode" class="form-label">Postcode</label>
                  <input type="text" class="form-control" id="postcode" placeholder="90805" (change)="onPostcodeChange($event)">
                </div>
              </div>
              <div class="col-auto my-1">
                <label for="distance" class="form-label">Distance</label>
                <select class="form-select"  id="distance" aria-label="Default select example" (change)="onDistanceChange($event)">
                  <option value="0"selected>Nationwide</option>
                  <option value="10">10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                  <option value="75">75</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </cdk-accordion-item>

      <cdk-accordion-item
        #accordionItemYear="cdkAccordionItem"
        class="accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-year'"
        [attr.aria-expanded]="accordionItemYear.expanded"
        [attr.aria-controls]="'accordion-body-year'">
        <div class="accordion-item-header" (click)="accordionItemYear.toggle()">
          Year
          <span class="accordion-item-description">
            <mat-icon
              class="accordion-item-icon"
              [color]="'primary'"
            >
              {{ accordionItemLocation.expanded ? 'expand_less'  : 'expand_more' }}</mat-icon>
          </span>
        </div>
        <div
          class="accordion-item-body"
          role="region"
          [style.display]="accordionItemYear.expanded ? '' : 'none'"
          [attr.id]="'accordion-body-year'"
          [attr.aria-labelledby]="'accordion-header-year'">
          <div class = "year-container">
            <select  id="start-year" class="form-select" aria-label="start-year" (change)="onChangeSelect($event)">
              <option selected>Select Start Year</option>
              <option *ngFor="let year of startYears" [value]="year" [selected]="year == startYear">{{ year }}</option>
            </select>
            <select id="end-year" class="form-select" aria-label="end-year" (change)="onChangeSelect($event)">
              <option selected>Select End Year</option>
              <option *ngFor="let year of endYears" [value]="year" [selected]="year == endYear">{{ year }}</option>
            </select>
          </div>
        </div>
      </cdk-accordion-item>

      <cdk-accordion-item
        #accordionItemMake="cdkAccordionItem"
        class="accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-make'"
        [attr.aria-expanded]="accordionItemMake.expanded"
        [attr.aria-controls]="'accordion-body-make'">
        <div class="accordion-item-header" (click)="accordionItemMake.toggle()">
          Make
          <span class="accordion-item-description">
            <mat-icon
              class="accordion-item-icon"
              [color]="'primary'"
            >
              {{ accordionItemLocation.expanded ? 'expand_less'  : 'expand_more' }}</mat-icon>
          </span>
        </div>
        <div
          class="accordion-item-body"
          role="region"
          [style.display]="accordionItemMake.expanded ? '' : 'none'"
          [attr.id]="'accordion-body-make'"
          [attr.aria-labelledby]="'accordion-header-make'">
          <div class = "make-container">
            <div *ngFor="let make of makes" class="form-check">
              <input class="form-check-input" name="make" type="checkbox" value="{{make.id}}"
                     id="make-{{make.id}}" (change)="onChangeCheck($event)"  [checked]="make.selected">
              <label class="form-check-label" for="make-{{make.id}}">
                {{make.name}}
              </label>
            </div>
          </div>
        </div>
      </cdk-accordion-item>

      <cdk-accordion-item
        #accordionItemBody="cdkAccordionItem"
        class="accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-body-type'"
        [attr.aria-expanded]="accordionItemBody.expanded"
        [attr.aria-controls]="'accordion-body-type'">
        <div class="accordion-item-header" (click)="accordionItemBody.toggle()">
          Body Type
          <span class="accordion-item-description">
            <mat-icon
              class="accordion-item-icon"
              [color]="'primary'"
            >
              {{ accordionItemLocation.expanded ? 'expand_less'  : 'expand_more' }}</mat-icon>
          </span>
        </div>
        <div
          class="accordion-item-body"
          role="region"
          [style.display]="accordionItemBody.expanded ? '' : 'none'"
          [attr.id]="'accordion-body-body-type'"
          [attr.aria-labelledby]="'accordion-header-body-type'">
          <div class = "body-container">
            <div *ngFor="let body of types" class="form-check">
              <input class="form-check-input" type="checkbox"  name="body" (change)="onChangeCheck($event)"
                     value="{{body.id}}" id="body-type-{{body.id}}" [checked]="body.selected">
              <label class="form-check-label" for="body-type-{{body.id}}">
                {{body.type}}
              </label>
            </div>
          </div>
        </div>
      </cdk-accordion-item>

      <cdk-accordion-item
        #accordionItemFuel="cdkAccordionItem"
        class="accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-fuel'"
        [attr.aria-expanded]="accordionItemFuel.expanded"
        [attr.aria-controls]="'accordion-body-fuel'">
        <div class="accordion-item-header" (click)="accordionItemFuel.toggle()">
          Fuel Type
          <span class="accordion-item-description">
            <mat-icon
              class="accordion-item-icon"
              [color]="'primary'"
            >
              {{ accordionItemLocation.expanded ? 'expand_less'  : 'expand_more' }}</mat-icon>
          </span>
        </div>
        <div
          class="accordion-item-body"
          role="region"
          [style.display]="accordionItemFuel.expanded ? '' : 'none'"
          [attr.id]="'accordion-body-fuel'"
          [attr.aria-labelledby]="'accordion-header-fuel'">
          <div class = "body-container">
            <div *ngFor="let fuel of fuels" class="form-check">
              <input class="form-check-input" type="checkbox" name="fuel" (change)="onChangeCheck($event)"
                     value="{{fuel.id}}" id="fuel-type-{{fuel.id}}" [checked]="fuel.selected">
              <label class="form-check-label" for="fuel-type-{{fuel.id}}">
                {{fuel.type}}
              </label>
            </div>
          </div>
        </div>
      </cdk-accordion-item>

      <cdk-accordion-item
        #accordionItemMiles="cdkAccordionItem"
        class="accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-miles'"
        [attr.aria-expanded]="accordionItemMiles.expanded"
        [attr.aria-controls]="'accordion-body-miles'">
        <div class="accordion-item-header" (click)="accordionItemMiles.toggle()">
          Mileage
          <span class="accordion-item-description">
            <mat-icon
              class="accordion-item-icon"
              [color]="'primary'"
            >
              {{ accordionItemLocation.expanded ? 'expand_less'  : 'expand_more' }}</mat-icon>
          </span>
        </div>
        <div
          class="accordion-item-body"
          role="region"
          [style.display]="accordionItemMiles.expanded ? '' : 'none'"
          [attr.id]="'accordion-body-body-miles'"
          [attr.aria-labelledby]="'accordion-header-body-miles'">
          <div class = "mileage-container">
            <label for="mileage" class="form-label">{{mileage}} miles or fewer</label>
            <ngx-slider [(value)]="mileage" [options]="optionsMiles" id="mileage" (userChange)="onChangeMileage($event)"></ngx-slider>
          </div>
        </div>
      </cdk-accordion-item>

      <cdk-accordion-item
        #accordionItemColor="cdkAccordionItem"
        class="accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-color'"
        [attr.aria-expanded]="accordionItemColor.expanded"
        [attr.aria-controls]="'accordion-body-color'">
        <div class="accordion-item-header" (click)="accordionItemColor.toggle()">
          Exterior Color
          <span class="accordion-item-description">
            <mat-icon
              class="accordion-item-icon"
              [color]="'primary'"
            >
              {{ accordionItemLocation.expanded ? 'expand_less'  : 'expand_more' }}</mat-icon>
          </span>
        </div>
        <div
          class="accordion-item-body"
          role="region"
          [style.display]="accordionItemColor.expanded ? '' : 'none'"
          [attr.id]="'accordion-body-color'"
          [attr.aria-labelledby]="'accordion-header-color'">
          <div class = "color-container">
            <label *ngFor="let color of colors"  class="container">
              {{color.name.charAt(0).toUpperCase() + color.name.slice(1).toLowerCase()}}
              <input type="checkbox" [checked]="color.selected" value="{{color.id}}" name="color" (change)="onChangeCheck($event)">
              <span class="checkmark" [ngStyle]="{'background-color': color.name.toLowerCase()}"></span>
            </label>
          </div>
        </div>
      </cdk-accordion-item>

      <cdk-accordion-item
        #accordionItemDrivetrain="cdkAccordionItem"
        class="accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-drivetrain'"
        [attr.aria-expanded]="accordionItemDrivetrain.expanded"
        [attr.aria-controls]="'accordion-body-drivetrain'">
        <div class="accordion-item-header" (click)="accordionItemDrivetrain.toggle()">
          Drivetrain
          <span class="accordion-item-description">
            <mat-icon
              class="accordion-item-icon"
              [color]="'primary'"
            >
              {{ accordionItemLocation.expanded ? 'expand_less'  : 'expand_more' }}</mat-icon>
          </span>
        </div>
        <div
          class="accordion-item-body"
          role="region"
          [style.display]="accordionItemDrivetrain.expanded ? '' : 'none'"
          [attr.id]="'accordion-body-drivetrain'"
          [attr.aria-labelledby]="'accordion-header-drivetrain'">
          <div class = "body-container">
            <div *ngFor="let drivetrain of drivetrains" class="form-check">
              <input class="form-check-input" type="checkbox" name="drivetrain" (change)="onChangeCheck($event)"
                     value="{{drivetrain.id}}" id="drive-type-{{drivetrain.id}}">
              <label class="form-check-label" for="drive-type-{{drivetrain.id}}">
                {{drivetrain.name}}
              </label>
            </div>
          </div>
        </div>
      </cdk-accordion-item>

      <cdk-accordion-item
        #accordionItemTransmission="cdkAccordionItem"
        class="accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-transmission'"
        [attr.aria-expanded]="accordionItemTransmission.expanded"
        [attr.aria-controls]="'accordion-body-transmission'">
        <div class="accordion-item-header" (click)="accordionItemTransmission.toggle()">
          Transmission
          <span class="accordion-item-description">
            <mat-icon
              class="accordion-item-icon"
              [color]="'primary'"
            >
              {{ accordionItemLocation.expanded ? 'expand_less'  : 'expand_more' }}</mat-icon>
          </span>
        </div>
        <div
          class="accordion-item-body"
          role="region"
          [style.display]="accordionItemTransmission.expanded ? '' : 'none'"
          [attr.id]="'accordion-body-transmission'"
          [attr.aria-labelledby]="'accordion-header-transmission'">
          <div class = "body-container">
            <div *ngFor="let transmission of transmissions" class="form-check">
              <input class="form-check-input" type="checkbox" name="transmission" (change)="onChangeCheck($event)"
                     value="{{transmission.type}}" id="transmission-type-{{transmission.id}}">
              <label class="form-check-label" for="transmission-type-{{transmission.id}}">
                {{transmission.description}}
              </label>
            </div>
          </div>
        </div>
      </cdk-accordion-item>

      <cdk-accordion-item
        #accordionItemPrice="cdkAccordionItem"
        class="accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-price'"
        [attr.aria-expanded]="accordionItemPrice.expanded"
        [attr.aria-controls]="'accordion-body-price'">
        <div class="accordion-item-header" (click)="accordionItemPrice.toggle()">
          Price
          <span class="accordion-item-description">
            <mat-icon
              class="accordion-item-icon"
              [color]="'primary'"
            >
              {{ accordionItemLocation.expanded ? 'expand_less'  : 'expand_more' }}</mat-icon>
          </span>
        </div>
        <div
          class="accordion-item-body"
          role="region"
          [style.display]="accordionItemPrice.expanded ? '' : 'none'"
          [attr.id]="'accordion-body-price'"
          [attr.aria-labelledby]="'accordion-header-price'">
          <div class = "body-container">
              <ngx-slider [(value)]="value" [(highValue)]="highValue" [options]="options" (userChange)="onPriceChange($event)"></ngx-slider>
          </div>
        </div>
      </cdk-accordion-item>
    </cdk-accordion>
  </div>



  <div class="results-container">
    <div class="data-container">
      <div *ngIf="(results$ | async) as results; else loading">
        <div *ngFor="let auto of results.content">
          <app-auto-card [auto]="auto"></app-auto-card>
        </div>
        <div class="pagination">
          <mat-paginator [length]="results.totalElements"
                         [pageSize]="results.size"
                         [pageSizeOptions]="pageSizeOptions"
                         (page)="onPageChange($event)"
                         aria-label="Select page">
          </mat-paginator>
        </div>
      </div>
      <ng-template #loading>
        <mat-spinner
          class="spinner"
          [diameter]="100"
          [strokeWidth]="4"></mat-spinner>
      </ng-template>
    </div>
  </div>
</div>







